<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="/static/css/pure-min.css">
        <link rel="stylesheet" href="/static/css/style.css">
    </head>
    <body>
        <script type="text/x-handlebars" data-template-name="friend/create">
        <div class="new-message">
            <form class="pure-form">
                {{!textarea id="new-friend-message" placeholder="Post to your friends"
                    value=newMessage action="create"}}
                <div class="post">
                    <input {{!action 'create'}} type="submit" value="Post" class="pure-button pure-button-primary">
                </div>
            </form>
        </div>
        </script>

        <script type="text/x-handlebars" data-template-name="public/create">
        <div class="new-message">
            <form class="pure-form">
                {{!textarea id="new-public-message" placeholder="Post to everyone"
                    value=newMessage action="create"}}
                <div class="post">
                    <input {{!action 'create'}} type="submit" value="Post" class="pure-button pure-button-primary">
                </div>
            </form>
        </div>
        </script>

        <script type="text/x-handlebars" data-template-name="components/feed-tpl">
            {{!#each message in messages}}
                {{! message-tpl message=message}}
            {{!/each}}
        </script>

        <script type="text/x-handlebars" data-template-name="libre/index">
        <div class="pure-g-r feeds">
            <div class="pure-u-1-2">
                <div class="feed friend-feed">
                    <h2>Friends feed</h2>
                    <div class="messages">
                        <div class="message-to-friend">
                            {{! render "friend/create"}}
                        </div>
                        {{! feed-tpl messages=friends }}
                    </div>
                </div>
            </div>
            <div class="pure-u-1-2">
                <div class="feed public-feed">
                    <h2>Public feed</h2>
                    <div class="messages">
                        <div class="message-to-friend">
                            {{! render "public/create"}}
                        </div>
                        {{! feed-tpl messages=public }}
                    </div>
                </div>
            </div>
        </div>
        </script>

        <script type="text/x-handlebars" data-template-name="user_profile/index">
        <div class="pure-g">
            <div class="pure-u">
                Profile
            </div>
        </div>
        <div class="pure-g-r feeds">
            <div class="pure-u-1-2">
                <div class="feed friend-feed">
                    <h2>Friends feed</h2>
                    <div class="messages">
                        {{! feed-tpl messages=friends }}
                    </div>
                </div>
            </div>
            <div class="pure-u-1-2">
                <div class="feed public-feed">
                    <h2>Public feed</h2>
                    <div class="messages">
                        {{! feed-tpl messages=public }}
                    </div>
                </div>
            </div>
        </div>
        </script>

        <script type="text/x-handlebars" data-template-name="components/message-tpl">
            <div class="message">
                <div class="author-avatar"><img src="https://pbs.twimg.com/profile_images/1257042635/alf_bigger.JPG" /></div>
                <div class="message-content">
                    <div class="date">{{!#link-to 'message' message.id}} {{!message.formatedDate}}{{!/link-to}}</div>
                    <div class="author">{{!#link-to 'user_profile' message.author_username}}{{!message.author_fullname}} ({{!message.author_username}}){{!/link-to}}</a></div>
                    <div class="content">
                        {{!message.body}}
                    </div>
                </div>
                <div class="message-actions">
                    <div class="pure-g-r">
                        <div class="pure-u-1-3">
                            <div {{!bind-attr class=":like liked"}}><a href="#" {{!action 'toggleLike' message.id bubbles=false}}>&hearts;</a></div>
                        </div>
                        <div class="pure-u-1-3">
                            <div class="comment"><a href="#">Comment</a></div>
                        </div>
                        <div class="pure-u-1-3">
                            <div class="repost"><a href="#">&crarr;</a></div>
                        </div>
                    </div>
                </div>
           </div>
        </script>

        <script type="text/x-handlebars" data-template-name="libre">
        <header id="header">
            <div class="pure-g menu">
                <div class="pure-u-1-3">
                    <h1>{{!#link-to 'libre'}}Libre{{!/link-to}}</h1>
                </div>
                <div class="pure-u-2-3 login">
                    {{!#if authenticated}}
                    <input type="submit" value="Logout" class="pure-button">
                    {{!else}}
                    <form class="pure-form">
                        {{!input value=email size="15" placeholder="Email"}}
                        {{!input value=password type="password" size="15" placeholder="Password"}}
                        <input {{!action 'login'}} type="submit" value="Login" class="pure-button">
                    </form>
                    {{!/if}}
                </div>
            </div>
        </header>
        <section id="main">
            {{!outlet}}
        </section>
        </script>

        <script src="/static/js/jquery-1.10.2.min.js" type="text/javascript"></script>
        <script src="/static/js/handlebars-1.0.0.js" type="text/javascript"></script>
        <script src="/static/js/ember.js" type="text/javascript"></script>
        <script src="/static/js/ember-data.js" type="text/javascript"></script>
        <script src="/static/js/app.js" type="text/javascript"></script>
        {% if user %}
        <script type="text/javascript">
        App.LibreController.reopen({
            authenticated: true
        });
        </script>
        {% end %}
    </body>
</html>
